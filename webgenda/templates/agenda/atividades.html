{% extends "base.html" %}

{% block title %}Minhas Atividades{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Minhas Atividades</h1>
    <a href="{% url 'cadastrar_atividade' %}" class="btn-primary">Cadastrar Nova Atividade</a>
</div>

<div class="table-container">
    <table class="history-table">
        <thead>
            <tr>
                <th>
                    <a href="?year={{ selected_year }}&per_page={{ items_per_page }}&sort=titulo&direction={% if current_sort == 'titulo' and current_direction == 'asc' %}desc{% else %}asc{% endif %}">
                        Título
                        {% if current_sort == 'titulo' %}<i class="bi bi-arrow-{% if current_direction == 'asc' %}up{% else %}down{% endif %}"></i>{% endif %}
                    </a>
                </th>
                <th>
                    <a href="?year={{ selected_year }}&per_page={{ items_per_page }}&sort=tipo_geral&direction={% if current_sort == 'tipo_geral' and current_direction == 'asc' %}desc{% else %}asc{% endif %}">
                        Tipo
                        {% if current_sort == 'tipo_geral' %}<i class="bi bi-arrow-{% if current_direction == 'asc' %}up{% else %}down{% endif %}"></i>{% endif %}
                    </a>
                </th>
                <th>
                    <a href="?year={{ selected_year }}&per_page={{ items_per_page }}&sort=categoria&direction={% if current_sort == 'categoria' and current_direction == 'asc' %}desc{% else %}asc{% endif %}">
                        Categoria
                        {% if current_sort == 'categoria' %}<i class="bi bi-arrow-{% if current_direction == 'asc' %}up{% else %}down{% endif %}"></i>{% endif %}
                    </a>
                </th>
                <th>
                    <a href="?year={{ selected_year }}&per_page={{ items_per_page }}&sort=data_inicio&direction={% if current_sort == 'data_inicio' and current_direction == 'asc' %}desc{% else %}asc{% endif %}">
                        Data de Início
                        {% if current_sort == 'data_inicio' %}<i class="bi bi-arrow-{% if current_direction == 'asc' %}up{% else %}down{% endif %}"></i>{% endif %}
                    </a>
                </th>
                <th>
                    <a href="?year={{ selected_year }}&per_page={{ items_per_page }}&sort=data_fim&direction={% if current_sort == 'data_fim' and current_direction == 'asc' %}desc{% else %}asc{% endif %}">
                        Data de Fim
                        {% if current_sort == 'data_fim' %}<i class="bi bi-arrow-{% if current_direction == 'asc' %}up{% else %}down{% endif %}"></i>{% endif %}
                    </a>
                </th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for atividade in atividades_paginadas %}
                <tr>
                    <td>{{ atividade.titulo }}</td>
                    <td><span class="badge badge-{{ atividade.tipo_geral|lower }}">{{ atividade.tipo_geral }}</span></td>
                    <td>{{ atividade.categoria }}</td>
                    <td>{{ atividade.data_inicio|date:"d/m/Y" }}</td>
                    <td>{{ atividade.data_fim|date:"d/m/Y" }}</td>
                    <td>
                        <a href="{{ atividade.url_edicao }}" class="btn-secondary" style="padding: 5px 10px; font-size: 0.9em;">Editar</a>
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="6" style="text-align: center; padding: 20px;">Nenhuma atividade em andamento ou futura encontrada.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% include 'agenda/paginacao.html' with page_obj=atividades_paginadas %}

{% endblock %}